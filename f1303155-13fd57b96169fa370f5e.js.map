{"version":3,"sources":["webpack:///./src/components/viz/scoreViz.js"],"names":["cssTimeLine","display","media","width","cssCloseBtn","zIndex","position","top","right","height","cursor","opacity","content","backgroundColor","transform","cssTimeLineCon","cssLollipopCon","overflowX","background","marginTop","overflowY","borderRadius","cssLabel","textAlign","fontSize","marginBottom","left","cssLabelCon","pointerEvents","cssScoreText","cssTooltipStyle","boxShadow","padding","p","a","textDecoration","color","cssLineCon","alignItems","margin","cssLine","typeColor","d3","domain","range","prepareData","senateVoteData","meanScore","map","d","score","reduce","acc","cur","length","criteriaScore","fGrade","filter","senator","dGrade","cGrade","bGrade","labelGradeData","grade","posScore","findIndex","Math","floor","meanPos","id","CreateLabel","gradeObj","css","ScoreViz","props","placeholder","useStaticQuery","timelineRef","useRef","lollipopRef","useState","tooltip","setTooltip","tooltipStyle","setTooltipStyle","useEffect","data","placeholderImage","miniWidth","current","clientWidth","mainWidth","mainMargin","brushWidth","brush","extent","on","newXcor","selection","style","timelineSvg","append","attr","xTimeline","call","move","yTimeline","selectAll","enter","bandwidth","senator_method","forEach","pos","lolliSvg","topSection","gBrush","node","size","x0","x1","dx","deltaX","stopPropagation","preventDefault","xLolli","paddingInner","paddingOuter","tickSizeOuter","tickSizeInner","tickFormat","_","i","yLolli","text","toFixed","strokeType","strokeWidth","name","lastname","replace","this","childImageSharp","fluid","tooltipTop","clientY","tooltipLeft","clientX","window","innerWidth","overflow","createChart","updateChart","setScrolling","scrollTop","setScrollTop","onScroll","currentPosition","pageYOffset","addEventListener","title","votelog","href","target","rel","stroke","y1","x2","y2","ref","className","index","key"],"mappings":"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","file":"f1303155-13fd57b96169fa370f5e.js","sourcesContent":["import React, { useRef, useEffect, useState } from \"react\"\nimport { media } from \"../../styles\"\nimport * as d3 from \"d3\"\nimport { useStaticQuery, graphql } from \"gatsby\"\nimport _ from \"lodash\"\n\nconst cssTimeLine = {\n  display: \"none\",\n  [media(767)]: {\n    width: \"100%\",\n    display: \"flex\",\n  },\n}\n\nconst cssCloseBtn = {\n  zIndex: \"100\",\n  position: \"absolute\",\n  top: \"0.5rem\",\n  right: \"0.5rem\",\n  width: \"10px\",\n  height: \"10px\",\n  cursor: \"pointer\",\n  opacity: \"0.5\",\n  [media(767)]: {\n    right: \"0.5rem\",\n  },\n  \"&:hover\": {\n    opacity: \"1\",\n  },\n  \"&:before, &:after\": {\n    position: \"absolute\",\n    top: \"0\",\n    right: \"1.2rem\",\n    content: '\"\"',\n    height: \"12px\",\n    width: \"1px\",\n    backgroundColor: \"black\",\n  },\n  \"&:before\": {\n    transform: \"rotate(45deg)\",\n  },\n  \"&:after\": {\n    transform: \"rotate(-45deg)\",\n  },\n}\n\nconst cssTimeLineCon = {\n  display: \"none\",\n  [media(767)]: {\n    width: \"100%\",\n    display: \"flex\",\n    position: \"relative\",\n  },\n}\n\nconst cssLollipopCon = {\n  overflowX: \"scroll\",\n  background: \"rgba(238,240,144, 0.1)\",\n  [media(767)]: {\n    height: \"43.6rem\",\n    marginTop: \"2.6rem\",\n    overflowY: \"hidden\",\n    position: \"relative\",\n  },\n  \"::-webkit-scrollbar-track\": {\n    background: \"#DFDFDF\",\n  },\n  \"::-webkit-scrollbar\": {\n    height: 7,\n    background: \"#DFDFDF\",\n  },\n  \"::-webkit-scrollbar-thumb\": {\n    background: \"#F0324B\",\n    borderRadius: 6,\n  },\n}\n\nconst cssLabel = {\n  width: \"7.6rem\",\n  height: \"2.4rem\",\n  borderRadius: \"0.3rem\",\n  position: \"relative\",\n  background: \"#EEF090\",\n  textAlign: \"center\",\n  fontSize: \"1.4rem\",\n  marginBottom: \"0.8rem\",\n  zIndex: 9,\n  left: 0,\n}\n\nconst cssLabelCon = {\n  height: \"39.4rem\",\n  width: \"24rem\",\n  position: \"sticky\",\n  marginTop: \"-34rem\",\n  left: 0,\n  zIndex: 150,\n  pointerEvents: \"none\",\n}\n\nconst cssScoreText = {\n  fontSize: \"1.2rem\",\n}\n\nconst cssTooltipStyle = {\n  position: \"fixed\",\n  width: \"20.6rem\",\n  background: \"#fff\",\n  boxShadow: \"0px 1px 4px rgba(0, 0, 0, 0.25)\",\n  borderRadius: \"0.4rem\",\n  padding: \"1.2rem\",\n  zIndex: 99999,\n  p: {\n    fontSize: \"1.2rem\",\n    marginBottom: \"0.4rem\",\n  },\n  a: {\n    textDecoration: \"underline\",\n    fontSize: \"1rem\",\n    color: \"#999C00\",\n  },\n}\n\nconst cssLineCon = {\n  position: \"sticky\",\n  width: \"100%\",\n  left: 0,\n  display: \"flex\",\n  alignItems: \"center\",\n  p: {\n    fontSize: \"1rem\",\n    margin: 0,\n    padding: 0,\n  },\n  zIndex: \"100\",\n}\n\nconst cssLine = {\n  width: \"100%\",\n  height: \"0.1rem\",\n}\n\nconst type = [\"โดยตำแหน่ง\", \"เลือกโดย คสช.\", \"เลือกกันเอง\"]\nconst typeColor = d3\n  .scaleOrdinal()\n  .domain(type)\n  .range([\"#999C00\", \"#5739AC\", \"#FEACAC\"])\n\nfunction prepareData(senateVoteData) {\n  const meanScore =\n    senateVoteData.map(d => d.score).reduce((acc, cur) => acc + cur, 0) /\n    senateVoteData.length\n  const criteriaScore = [50, 60, 70, 80]\n  const fGrade = senateVoteData.filter(senator => senator.score < 50).length\n  const dGrade = senateVoteData.filter(\n    senator => senator.score > 50 && senator.score < 60\n  ).length\n  const cGrade = senateVoteData.filter(\n    senator => senator.score > 60 && senator.score < 70\n  ).length\n  const bGrade = senateVoteData.filter(\n    senator => senator.score > 70 && senator.score < 80\n  ).length\n  const aGrade = senateVoteData.filter(senator => senator.score > 80).length\n  const labelGradeData = [\n    { grade: \"A\", score: aGrade },\n    { grade: \"B\", score: bGrade },\n    { grade: \"C\", score: cGrade },\n    { grade: \"D\", score: dGrade },\n    { grade: \"F\", score: fGrade },\n  ]\n  const posScore = criteriaScore.map(score => {\n    return senateVoteData.findIndex(d => Math.floor(d.score) === score)\n  })\n  const meanPos = senateVoteData.filter(\n    d => Math.floor(d.score) === Math.floor(meanScore)\n  )[0].id\n  return {\n    criteriaScore,\n    posScore,\n    meanPos,\n    labelGradeData,\n  }\n}\n\nfunction createChart(\n  data,\n  timelineRef,\n  lollipopRef,\n  setTooltip,\n  setTooltipStyle,\n  placeholder\n) {\n  const { criteriaScore, posScore, meanPos } = prepareData(data)\n  const placeholderImage = _.get(\n    placeholder,\n    \"placeholderImage.childImageSharp.fluid.src\"\n  )\n  const miniHeight = 88\n  const miniWidth = timelineRef.current.clientWidth\n\n  const mainHeight = 394\n  const mainWidth = lollipopRef.current.clientWidth\n  const mainMargin = {\n    left: 20,\n    right: 20,\n    bottom: 16,\n    top: 34,\n  }\n  const maxWidth = 12000\n\n  const brushWidth = (mainWidth / maxWidth) * miniWidth\n\n  function brushmove() {\n    const extentX = d3.event.selection\n    const newXcor = -extentX[0] * (maxWidth / mainWidth)\n    d3.select(lollipopRef.current).style(\n      \"transform\",\n      `translate(${newXcor}px,0px)`\n    )\n  }\n\n  function scroll() {\n    const gBrush = d3.select(\".brush\")\n    let selection = d3.brushSelection(gBrush.node())\n    let size = selection[1] - selection[0],\n      range = xTimeline.range(),\n      x0 = d3.min(range),\n      x1 = d3.max(range),\n      dx = -d3.event.deltaX,\n      topSection\n\n    if (selection[0] - dx < x0) {\n      topSection = x0\n    } else if (selection[1] - dx > x1) {\n      topSection = x1 - size\n    } else {\n      topSection = selection[0] - dx\n    }\n    d3.event.stopPropagation()\n    d3.event.preventDefault()\n    gBrush.call(brush.move, [topSection, topSection + size])\n  }\n\n  const brush = d3\n    .brushX()\n    .extent([[0, 0], [miniWidth, miniHeight]])\n    .on(\"brush\", brushmove)\n\n  const timelineSvg = d3\n    .select(timelineRef.current)\n    .append(\"svg\")\n    .attr(\"width\", miniWidth)\n    .attr(\"height\", miniHeight)\n    .style(\"pointer-events\", \"none\")\n\n  const xTimeline = d3\n    .scaleBand()\n    .domain(\n      data.map(function(d) {\n        return d.id\n      })\n    )\n    .range([0, miniWidth])\n    .padding(0.2)\n\n  timelineSvg\n    .append(\"g\")\n    .attr(\"class\", \"brush\")\n    .call(brush)\n    .call(brush.move, [0, brushWidth])\n\n  const yTimeline = d3\n    .scaleLinear()\n    .domain([0, 100])\n    .range([miniHeight, 0])\n\n  const miniBar = timelineSvg\n    .selectAll(\"timelineBar\")\n    .data(data)\n    .enter()\n  miniBar\n    .append(\"rect\")\n    .attr(\"class\", \"miniBar\")\n    .attr(\"x\", function(d) {\n      return xTimeline(d.id)\n    })\n    .attr(\"y\", function(d) {\n      return yTimeline(d.score)\n    })\n    .attr(\"width\", xTimeline.bandwidth())\n    .attr(\"height\", function(d) {\n      return miniHeight - yTimeline(d.score)\n    })\n    .attr(\"fill\", function(d) {\n      return typeColor(d.senator_method)\n    })\n\n  d3.selectAll(\".handle\").style(\"pointer-events\", \"none\")\n  d3.select(\".overlay\").style(\"pointer-events\", \"none\")\n\n  // let sumPos = 0\n  posScore.forEach(pos => {\n    if (pos === -1) return\n    timelineSvg\n      .append(\"line\")\n      .attr(\"x1\", xTimeline(data[pos].id))\n      .attr(\"x2\", xTimeline(data[pos].id))\n      .attr(\"y1\", 0)\n      .attr(\"y2\", 88)\n      .attr(\"stroke\", \"#AEAEAE\")\n      .attr(\"stroke-dasharray\", \"4\")\n\n    // const leftPos = sumPos + xTimeline(data[pos].id) / 2\n    // const legend = document.createElement(\"p\")\n    // legend.innerText = \"A\"\n    // legend.style.cssText = `position: absolute; top: 0; left: ${leftPos}px`\n    // document.getElementById(\"timeline-viz\").appendChild(legend)\n    // sumPos += xTimeline(data[pos].id)\n  })\n\n  timelineSvg\n    .append(\"line\")\n    .attr(\"x1\", xTimeline(meanPos))\n    .attr(\"x2\", xTimeline(meanPos))\n    .attr(\"y1\", 0)\n    .attr(\"y2\", 88)\n    .attr(\"stroke\", \"#F0324B\")\n\n  const lolliSvg = d3\n    .select(lollipopRef.current)\n    .append(\"svg\")\n    .attr(\"height\", mainHeight + mainMargin.top)\n    .attr(\"width\", maxWidth)\n    .on(\"wheel.zoom\", scroll)\n\n  const xLolli = d3\n    .scaleBand()\n    .domain(data.map(d => d.id))\n    .range([0, maxWidth])\n    .paddingInner(0.9)\n    .paddingOuter(0.5)\n\n  lolliSvg\n    .append(\"g\")\n    .attr(\"transform\", `translate(0,378)`)\n    .call(\n      d3\n        .axisBottom(xLolli)\n        .tickSizeOuter(0)\n        .tickSizeInner(0)\n        .tickFormat(function(_, i) {\n          return i + 1\n        })\n    )\n\n  const yLolli = d3\n    .scaleLinear()\n    .domain([0, 100])\n    .range([mainHeight, mainMargin.top + 40])\n\n  lolliSvg\n    .selectAll(\"group\")\n    .data(data)\n    .enter()\n    .append(\"g\")\n    .attr(\"class\", \"group\")\n    .append(\"rect\")\n    .attr(\"class\", \"lolliBar\")\n    .attr(\"x\", function(d) {\n      return xLolli(d.id)\n    })\n    .attr(\"y\", function(d) {\n      return yLolli(d.score) - mainMargin.bottom\n    })\n    .attr(\"width\", xLolli.bandwidth())\n    .attr(\"height\", function(d) {\n      return mainHeight - yLolli(d.score)\n    })\n    .attr(\"fill\", function(d) {\n      return typeColor(d.senator_method)\n    })\n\n  d3.selectAll(\".group\")\n    .append(\"text\")\n    .attr(\"class\", \"percentText\")\n    .attr(\"x\", function(d) {\n      return xLolli(d.id) - 5\n    })\n    .attr(\"y\", function(d) {\n      return yLolli(d.score) - mainMargin.bottom - 20 - 30\n    })\n    .attr(\"fill\", \"#828282\")\n    .attr(\"font-size\", \"1.2rem\")\n    .attr(\"dominant-baseline\", \"middle\")\n    // .attr(\"text-anchor\", \"middle\")\n    .text(function(d) {\n      return `${d.score.toFixed(0)}%`\n    })\n\n  d3.select(\".selection\")\n    .attr(\"fill\", \"#EEF090\")\n    .attr(\"stroke-width\", 1)\n    .attr(\"stroke\", \"rgba(0,0,0,0.2)\")\n    .attr(\"z-index\", 9999999)\n\n  criteriaScore.forEach((score, i) => {\n    const strokeType = score === 100 ? \"stroke-width\" : \"stroke-dasharray\"\n    const strokeWidth = score === 100 ? 1 : 0.5\n    lolliSvg\n      .append(\"line\")\n      .attr(\"x1\", 0)\n      .attr(\"x2\", maxWidth)\n      .attr(\"y1\", yLolli(score) - mainMargin.bottom)\n      .attr(\"y2\", yLolli(score) - mainMargin.bottom)\n      .attr(\"stroke\", \"#AEAEAE\")\n      .attr(strokeType, \"2\")\n      .attr(\"stroke-width\", strokeWidth)\n  })\n  d3.selectAll(\".group\")\n    .append(\"svg:defs\")\n    .append(\"svg:pattern\")\n    .attr(\"id\", function(_, i) {\n      return \"profile\" + i\n    })\n    .attr(\"width\", 40)\n    .attr(\"height\", 40)\n    .attr(\"patternUnits\", \"userSpaceOnUse\")\n    .append(\"svg:image\")\n    .attr(\"xlink:href\", function(d) {\n      return `https://elect.thematter.co/data/politicians/${\n        d.name\n      }-${d.lastname.replace(/ /g, \"-\")}.jpg`\n    })\n    .on(\"error\", function(d) {\n      d3.select(this).attr(\"xlink:href\", placeholderImage)\n    })\n    .attr(\"fluid\", placeholder.placeholderImage.childImageSharp.fluid)\n    .attr(\"width\", 40)\n    .attr(\"height\", 40)\n    .attr(\"x\", 0)\n    .attr(\"y\", 0)\n\n  d3.selectAll(\".group\")\n    .append(\"circle\")\n    .attr(\"class\", d => `circle${d.id}`)\n    .attr(\"transform\", function(d) {\n      const x = xLolli(d.id) - 20 + xLolli.bandwidth() / 2\n      const y = yLolli(d.score) - mainMargin.bottom - 40\n      return `translate(${x}, ${y})`\n    })\n    .attr(\"cx\", 20)\n    .attr(\"cy\", 20)\n    .attr(\"r\", 20)\n    .style(\"fill\", \"#fff\")\n    .style(\"fill\", function(_, i) {\n      return \"url(#profile\" + i + \")\"\n    })\n    .style(\"cursor\", \"pointer\")\n    .attr(\"stroke\", \"black\")\n    .attr(\"stroke-width\", 1)\n    .on(\"mouseover\", function(d) {\n      d3.selectAll(\"circle\").attr(\"stroke-width\", 1)\n      d3.select(`.circle${d.id}`).attr(\"stroke-width\", 2)\n      const tooltipTop = d3.event.clientY - mainMargin.bottom - 120\n      const tooltipLeft =\n        d3.event.clientX + 250 > window.innerWidth\n          ? d3.event.clientX - 200\n          : d3.event.clientX + 10\n      setTooltip(d)\n      setTooltipStyle({\n        ...cssTooltipStyle,\n        top: tooltipTop,\n        left: tooltipLeft,\n        overflow: \"hidden\",\n        opacity: 1,\n      })\n    })\n    .on(\"click\", function(d) {\n      d3.select(\"#closeBtn\").on(\"click\", function() {\n        d3.select(`.circle${d.id}`).attr(\"stroke-width\", 1)\n        setTooltipStyle({\n          width: 0,\n          height: 0,\n          top: null,\n          left: null,\n          opacity: 0,\n        })\n      })\n    })\n}\n\nfunction updateChart(filter) {\n  if (filter === \"โดยตำแหน่ง\") {\n    d3.selectAll(\".group\").style(\"opacity\", function(d) {\n      return filter !== d.senator_method ? \"0.1\" : \"1\"\n    })\n    d3.selectAll(\".miniBar\").style(\"opacity\", function(d) {\n      return filter !== d.senator_method ? \"0.1\" : \"1\"\n    })\n  } else if (filter === \"เลือกโดย คสช.\") {\n    d3.selectAll(\".group\").style(\"opacity\", function(d) {\n      return filter !== d.senator_method ? \"0.1\" : \"1\"\n    })\n    d3.selectAll(\".miniBar\").style(\"opacity\", function(d) {\n      return filter !== d.senator_method ? \"0.1\" : \"1\"\n    })\n  } else if (filter === \"เลือกกันเอง\") {\n    d3.selectAll(\".group\").style(\"opacity\", function(d) {\n      return filter !== d.senator_method ? \"0.1\" : \"1\"\n    })\n    d3.selectAll(\".miniBar\").style(\"opacity\", function(d) {\n      return filter !== d.senator_method ? \"0.1\" : \"1\"\n    })\n  } else {\n    d3.selectAll(\".group\").style(\"opacity\", function(d) {\n      return \"1\"\n    })\n    d3.selectAll(\".miniBar\").style(\"opacity\", function(d) {\n      return \"1\"\n    })\n  }\n}\n\nfunction CreateLabel({ gradeObj }) {\n  return (\n    <div css={{ ...cssLabel }}>\n      <strong>{gradeObj.grade}</strong>{\" \"}\n      <span css={{ ...cssScoreText }}>{gradeObj.score} คน</span>\n    </div>\n  )\n}\n\nconst ScoreViz = props => {\n  const placeholder = useStaticQuery(graphql`\n    query {\n      placeholderImage: file(\n        relativePath: { eq: \"images/people/placeholder.png\" }\n      ) {\n        childImageSharp {\n          fluid(maxWidth: 84) {\n            ...GatsbyImageSharpFluid\n          }\n        }\n      }\n    }\n  `)\n  const { senateVoteData, filter } = props\n  const { labelGradeData } = prepareData(senateVoteData)\n  const timelineRef = useRef(null)\n  const lollipopRef = useRef(null)\n\n  const [tooltip, setTooltip] = useState(null)\n  const [tooltipStyle, setTooltipStyle] = useState({\n    position: \"absolute\",\n    width: 0,\n    left: null,\n    top: null,\n    opacity: 0,\n  })\n\n  useEffect(() => {\n    createChart(\n      senateVoteData,\n      timelineRef,\n      lollipopRef,\n      setTooltip,\n      setTooltipStyle,\n      placeholder\n    )\n  }, [])\n\n  useEffect(() => {\n    updateChart(filter)\n  }, [filter])\n\n  const [scrolling, setScrolling] = useState(false)\n  const [scrollTop, setScrollTop] = useState(0)\n  useEffect(() => {\n    function onScroll() {\n      let currentPosition = window.pageYOffset // or use document.documentElement.scrollTop;\n      if (currentPosition > scrollTop) {\n        // downscroll code\n        setScrolling(false)\n      } else {\n        // upscroll code\n        setScrolling(true)\n      }\n      setScrollTop(currentPosition <= 0 ? 0 : currentPosition)\n    }\n\n    setTooltipStyle({\n      position: \"absolute\",\n      width: 0,\n      height: 0,\n      top: null,\n      left: null,\n      opacity: 0,\n    })\n\n    window.addEventListener(\"scroll\", _.throttle(onScroll, 10000))\n    return window.addEventListener(\"scroll\", _.throttle(onScroll, 10000))\n  }, [scrollTop])\n\n  return (\n    <div>\n      {tooltip ? (\n        <div css={{ ...tooltipStyle }}>\n          <div css={{ ...cssCloseBtn }} id=\"closeBtn\" />\n          <strong>\n            <p>\n              {tooltip.title} {tooltip.name} {tooltip.lastname}\n            </p>\n          </strong>\n          <p>ระยะเวลาทำงาน 145 ครั้ง</p>\n          <p>เข้าลงมติ {tooltip.votelog} ครั้ง</p>\n          <a\n            href={`https://theyworkforus.elect.in.th/people/${\n              tooltip.name\n            }-${tooltip.lastname.replace(/ /g, \"-\")}`}\n            target=\"_blank\"\n            rel=\"noopener noreferrer\"\n            css={{ display: \"flex\", alignItems: \"center\" }}\n          >\n            ดูโปรไฟล์\n            <svg css={{ width: 10, height: 10, fill: \"none\", marginLeft: 8 }}>\n              <path\n                d=\"M2.49999 1.66663H0.833328V9.16663H8.33333V7.49996\"\n                stroke=\"#999C00\"\n              />\n              <line\n                x1=\"8.68688\"\n                y1=\"1.18693\"\n                x2=\"3.68688\"\n                y2=\"6.18693\"\n                stroke=\"#999C00\"\n              />\n              <path d=\"M5 0.833374H9.16667V5.00004\" stroke=\"#999C00\" />\n            </svg>\n          </a>\n        </div>\n      ) : (\n        <></>\n      )}\n      <div css={{ ...cssTimeLineCon }} id=\"timeline-viz\">\n        <div ref={timelineRef} css={{ ...cssTimeLine }} />\n      </div>\n      <div css={{ ...cssLollipopCon }} className=\"senate_scroll\">\n        <div css={{ ...cssLineCon, top: \"8rem\", pointerEvents: \"none\" }}>\n          <div css={{ ...cssLine, background: \"#AEAEAE\" }} />\n          <p\n            css={{\n              width: \"20rem\",\n              textAlign: \"center\",\n              fontWeight: \"700\",\n              color: \"#AEAEAE\",\n              background: \"rgba(255,255,255,0.8)\",\n              borderRadius: \"0.3rem\",\n            }}\n          >\n            คะแนนเต็ม 100%\n          </p>\n          <div css={{ ...cssLine, background: \"#AEAEAE\" }} />\n        </div>\n        <div css={{ ...cssLineCon, top: \"16rem\", pointerEvents: \"none\" }}>\n          <div css={{ ...cssLine, background: \"#F0324B\" }} />\n          <p\n            css={{\n              width: \"20rem\",\n              textAlign: \"center\",\n              color: \"#F0324B\",\n              fontWeight: \"700\",\n              background: \"rgba(255,255,255,0.8)\",\n              borderRadius: \"0.3rem\",\n            }}\n          >\n            คะแนนเฉลี่ย 75%\n          </p>\n          <div css={{ ...cssLine, background: \"#F0324B\" }} />\n        </div>\n        <div ref={lollipopRef} />\n        <div css={{ ...cssLabelCon }}>\n          {labelGradeData.map((gradeObj, index) => {\n            return <CreateLabel gradeObj={gradeObj} key={index} />\n          })}\n        </div>\n      </div>\n    </div>\n  )\n}\n\nexport default ScoreViz\n"],"sourceRoot":""}